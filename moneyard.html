<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Moneyard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{margin:0;background:#052e2b;color:#fff;font-family:system-ui}
button{padding:14px;border:none;border-radius:12px;cursor:pointer}
.primary{background:#facc15;color:#052e2b;font-weight:600}
.card{background:#022c22;padding:20px;border-radius:18px;margin-bottom:20px}
#txModal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.7);align-items:center;justify-content:center}
.modal{background:#022c22;padding:20px;border-radius:18px;width:90%;max-width:400px}
input,select{width:100%;padding:12px;margin-bottom:10px;border:none;border-radius:10px;background:#052e2b;color:#fff}
.tx{display:flex;justify-content:space-between;padding:10px 0;border-bottom:1px solid #064e3b}
</style>
</head>

<body>

<div class="card" id="authBox">
  <h3>Moneyard</h3>
  <button class="primary" onclick="login()">Sign in with Google</button>
</div>

<div class="card">
  <h2 id="total">USD 0.00</h2>
</div>

<div class="card">
  <button class="primary" onclick="openModal()">âž• Add Transaction</button>
</div>

<div class="card" id="txList"></div>

<!-- MODAL -->
<div id="txModal">
  <div class="modal">
    <h3>Add Transaction</h3>
    <input id="amount" type="number" placeholder="Amount">
    <select id="type">
      <option value="income">Income</option>
      <option value="expense">Expense</option>
      <option value="transfer">Transfer</option>
    </select>
    <select id="from">
      <option value="cash">Cash</option>
      <option value="mobile">Mobile</option>
      <option value="crypto">Crypto</option>
    </select>
    <select id="to">
      <option value="">To (transfer)</option>
      <option value="cash">Cash</option>
      <option value="mobile">Mobile</option>
      <option value="crypto">Crypto</option>
    </select>
    <button class="primary" onclick="saveTx()">Save</button>
    <button onclick="closeModal()">Cancel</button>
  </div>
</div>

<!-- FIREBASE v8 (NO MODULES) -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<script>
/* ðŸ”¥ PUT YOUR FIREBASE CONFIG HERE ðŸ”¥ */
firebase.initializeApp({
  apiKey: "",
  authDomain: "",
  databaseURL: "",
  projectId: "",
  appId: ""
});

const db = firebase.database();
const auth = firebase.auth();

let uid = null;

/* AUTH */
function login(){
  const provider = new firebase.auth.GoogleAuthProvider();
  auth.signInWithPopup(provider).then(res=>{
    uid = res.user.uid;
    document.getElementById("authBox").style.display="none";
    db.ref("users/"+uid+"/balance").set(0);
    listen();
  });
}

/* MODAL */
function openModal(){
  if(!uid) return alert("Sign in first");
  document.getElementById("txModal").style.display="flex";
}
function closeModal(){
  document.getElementById("txModal").style.display="none";
}

/* SAVE TX */
function saveTx(){
  const amt = Number(amount.value);
  if(!amt) return alert("Enter amount");

  db.ref("users/"+uid+"/tx").push({
    amount:amt,
    type:type.value,
    from:from.value,
    to:to.value||null,
    time:Date.now()
  });

  db.ref("users/"+uid+"/balance").transaction(b=> (b||0)+amt);
  closeModal();
}

/* LISTEN */
function listen(){
  db.ref("users/"+uid+"/tx").on("value",s=>{
    txList.innerHTML="";
    let total=0;
    s.forEach(c=>{
      const t=c.val();
      total+=t.amount;
      txList.innerHTML+=`
        <div class="tx">
          <span>${t.type}</span>
          <span>${t.amount}</span>
        </div>`;
    });
    totalEl(total);
  });
}

function totalEl(v){
  document.getElementById("total").textContent="USD "+v.toFixed(2);
}
</script>

</body>
</html>

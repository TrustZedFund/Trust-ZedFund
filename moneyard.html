<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Moneyard – Know Your Money</title>

<style>
body {
  font-family: system-ui, Arial;
  margin: 0;
  background: #f4f6f8;
  color: #222;
}
header {
  background: #1e88e5;
  color: white;
  padding: 20px;
}
header h1 {
  margin: 0;
}
header p {
  margin: 6px 0 0;
  opacity: 0.9;
}
main {
  padding: 20px;
  max-width: 900px;
  margin: auto;
}
section {
  margin-bottom: 20px;
}
.card {
  background: white;
  padding: 16px;
  border-radius: 6px;
  margin-bottom: 12px;
}
.grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
  gap: 12px;
}
input, select, button {
  width: 100%;
  padding: 10px;
  margin-top: 8px;
}
button {
  background: #1e88e5;
  color: white;
  border: none;
  cursor: pointer;
}
button.secondary {
  background: #555;
}
.hidden {
  display: none;
}
small {
  color: #666;
}
.status-good { color: green; }
.status-warn { color: orange; }
.status-bad { color: red; }
</style>
</head>

<body>

<header>
  <h1>Moneyard</h1>
  <p>Know where your money stands — today, this month, and next.</p>
</header>

<main>

<!-- AUTH -->
<section id="authSection">
  <div class="card">
    <h2>Get Started</h2>
    <p>Create an account to see your money clearly.</p>
    <input id="email" placeholder="Email">
    <input id="password" type="password" placeholder="Password">
    <button onclick="signup()">Create account</button>
    <button class="secondary" onclick="login()">Login</button>
  </div>
</section>

<!-- ONBOARDING -->
<section id="onboarding" class="hidden">
  <div class="card">
    <h2>Quick setup (2 minutes)</h2>
    <small>This helps Moneyard give you accurate insights.</small>

    <input id="income" type="number" placeholder="Monthly income">
    <input id="rent" type="number" placeholder="Rent">
    <input id="utilities" type="number" placeholder="Utilities">
    <input id="transport" type="number" placeholder="Transport">
    <input id="savings" type="number" placeholder="Monthly savings goal">

    <button onclick="saveProfile()">Continue to dashboard</button>
  </div>
</section>

<!-- DASHBOARD -->
<section id="dashboard" class="hidden">

  <div class="grid">
    <div class="card" id="snapshotCard"></div>
    <div class="card" id="burnCard"></div>
    <div class="card" id="healthCard"></div>
  </div>

  <div class="grid">
    <div class="card">
      <h3>Add an expense</h3>
      <input id="expenseAmount" type="number" placeholder="Amount">
      <select id="expenseCategory">
        <option>Food</option>
        <option>Transport</option>
        <option>Rent</option>
        <option>Utilities</option>
        <option>Data</option>
        <option>Misc</option>
      </select>
      <button onclick="addExpense()">Add expense</button>
    </div>

    <div class="card">
      <h3>Can I afford this?</h3>
      <small>Quick decision before you spend.</small>
      <input id="affordAmount" type="number" placeholder="Amount">
      <button onclick="checkAfford()">Check</button>
      <p id="affordResult"></p>
    </div>
  </div>

  <div class="card">
    <h3>Savings progress</h3>
    <div id="savingsView"></div>
  </div>

  <div class="card">
    <h3>Upgrade to Pro</h3>
    <p>$5/month — USDT (TRC20)</p>
    <p><b>Wallet:</b> YOUR_USDT_WALLET</p>
    <button onclick="requestUpgrade()">I’ve paid</button>
  </div>

</section>

</main>

<!-- FIREBASE -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
firebase.initializeApp({
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_PROJECT.firebaseapp.com",
  databaseURL: "https://YOUR_PROJECT.firebaseio.com",
  projectId: "YOUR_PROJECT",
  appId: "YOUR_APP_ID"
});

const auth = firebase.auth();
const db = firebase.database();

let uid, profile = {}, spent = 0;

auth.onAuthStateChanged(user => {
  if (!user) return;
  uid = user.uid;
  authSection.classList.add("hidden");
  loadProfile();
});

function signup() {
  auth.createUserWithEmailAndPassword(email.value, password.value);
}
function login() {
  auth.signInWithEmailAndPassword(email.value, password.value);
}

function saveProfile() {
  profile = {
    income:+income.value,
    rent:+rent.value,
    utilities:+utilities.value,
    transport:+transport.value,
    savings:+savings.value
  };
  db.ref("profiles/"+uid).set(profile);
  showDashboard();
}

function loadProfile() {
  db.ref("profiles/"+uid).once("value", snap => {
    if (!snap.exists()) onboarding.classList.remove("hidden");
    else {
      profile = snap.val();
      showDashboard();
    }
  });
}

function showDashboard() {
  onboarding.classList.add("hidden");
  dashboard.classList.remove("hidden");
  listenExpenses();
}

function listenExpenses() {
  db.ref("transactions/"+uid).on("value", snap => {
    spent = 0;
    snap.forEach(tx => spent += tx.val().amount);
    render();
  });
}

function addExpense() {
  db.ref("transactions/"+uid).push({
    amount:+expenseAmount.value,
    category:expenseCategory.value,
    date:Date.now()
  });
}

function render() {
  const fixed = profile.rent + profile.utilities + profile.transport;
  const remaining = profile.income - fixed - spent - profile.savings;
  const daysLeft = Math.max(1, 30 - new Date().getDate());
  const daily = remaining / daysLeft;

  snapshotCard.innerHTML = `
    <h3>Money snapshot</h3>
    <p>Income: <b>${profile.income}</b></p>
    <p>Spent: <b>${spent}</b></p>
    <p>Remaining: <b>${remaining}</b></p>
  `;

  burnCard.innerHTML = `
    <h3>Burn rate</h3>
    <p>Safe daily spend:</p>
    <h2>${daily.toFixed(2)}</h2>
  `;

  healthCard.innerHTML = `
    <h3>Money health</h3>
    <p class="${remaining > 0 ? 'status-good' : 'status-bad'}">
      ${remaining > 0 ? "Healthy" : "At risk"}
    </p>
  `;

  savingsView.innerHTML = `
    Goal: ${profile.savings}<br>
    Status: ${remaining >= 0 ? "On track" : "Behind"}
  `;
}

function checkAfford() {
  const amount = +affordAmount.value;
  const fixed = profile.rent + profile.utilities + profile.transport;
  const remaining = profile.income - fixed - spent - profile.savings;
  const daily = remaining / (30 - new Date().getDate());

  affordResult.innerText =
    amount <= daily ? "✅ Safe" :
    amount <= daily * 1.5 ? "⚠️ Risky" :
    "❌ Not recommended";
}

function requestUpgrade() {
  db.ref("payments").push({
    uid,
    amount:5,
    method:"USDT",
    status:"pending",
    time:Date.now()
  });
  alert("Upgrade request submitted.");
}
</script>

</body>
</html>

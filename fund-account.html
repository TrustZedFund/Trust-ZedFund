<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Fund Account</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  background:#0b2e1f;
  color:white;
  font-family:Arial, sans-serif;
  padding:20px;
}
.card {
  background:#114d36;
  padding:20px;
  border-radius:14px;
  max-width:450px;
  margin:auto;
}
input, select, button {
  width:100%;
  padding:12px;
  margin-bottom:12px;
  border:none;
  background:#0b2e1f;
  color:white;
}
button {
  background:#1dd88a;
  font-weight:bold;
  cursor:pointer;
}
.status {
  font-size:14px;
}
</style>
</head>

<body>

<div class="card">
  <h2>Deposit USDT</h2>

  <select id="method">
    <option value="">Select Payment Method</option>
    <option value="USDT-BEP20">USDT (BEP20 - BSC)</option>
    <option value="USDT-TRC20">USDT (TRC20 - TRON)</option>
    <option value="BINANCE-ID">Binance ID Transfer</option>
  </select>

  <input type="number" id="amount" placeholder="Amount sent (USDT)">

  <input type="file" id="proof">

  <button id="submit">Submit Proof</button>

  <p class="status" id="status"></p>
</div>

<script type="module">
import { auth } from "./firebase.js";
import { submitDepositProof } from "./firebase.js";
import { onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-auth.js";

const submitBtn = document.getElementById("submit");
const status = document.getElementById("status");

let currentUser = null;

onAuthStateChanged(auth, user => {
  if (!user) {
    status.textContent = "❌ Please login first";
    submitBtn.disabled = true;
    return;
  }
  currentUser = user;
});

submitBtn.onclick = async () => {
  const method = document.getElementById("method").value;
  const amount = Number(document.getElementById("amount").value);
  const file = document.getElementById("proof").files[0];

  if (!method || !amount || !file) {
    status.textContent = "⚠ Fill all fields";
    return;
  }

  try {
    status.textContent = "Uploading proof...";
    await submitDepositProof(currentUser.uid, { method, amount }, file);
    status.textContent = "✅ Deposit submitted. Await approval.";
  } catch (err) {
    status.textContent = "❌ " + err.message;
  }
};
</script>

</body>
</html>

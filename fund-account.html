<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Fund Account | Trust ZedFund</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  background: #0b2e1f;
  font-family: Arial, sans-serif;
  color: #ffffff;
  margin: 0;
  padding: 20px;
}

.container {
  max-width: 460px;
  margin: auto;
}

h2 {
  text-align: center;
  margin-bottom: 25px;
}

.method-card {
  background: #114d36;
  padding: 20px;
  border-radius: 14px;
  margin-bottom: 20px;
  box-shadow: 0 8px 25px rgba(0,0,0,0.35);
}

.method-card h3 { margin: 0 0 6px; }

.network {
  font-size: 13px;
  color: #c7f5dd;
  margin-bottom: 12px;
}

.address-box {
  display: flex;
  gap: 8px;
}

.address-box input {
  flex: 1;
  padding: 10px;
  background: #0b2e1f;
  border: none;
  border-radius: 6px;
  color: #fff;
  font-size: 13px;
}

.address-box button {
  background: #f4c430;
  border: none;
  padding: 10px 14px;
  border-radius: 6px;
  font-weight: bold;
  cursor: pointer;
}

.warning {
  font-size: 13px;
  color: #ffb3b3;
  margin-top: 10px;
}

.note {
  font-size: 13px;
  color: #a7ffcf;
  margin-top: 10px;
}

.highlight {
  border: 1px solid #1dd88a;
}

.upload-card {
  background: #0f3f2d;
  padding: 20px;
  border-radius: 14px;
  margin-top: 30px;
}

.upload-card label {
  display: block;
  font-size: 14px;
  margin-bottom: 6px;
}

.upload-card input,
.upload-card select {
  width: 100%;
  padding: 10px;
  background: #0b2e1f;
  border: none;
  border-radius: 6px;
  color: #fff;
  margin-bottom: 14px;
}

.upload-card input[type="file"] { background: none; }

.submit-btn {
  width: 100%;
  padding: 12px;
  background: #1dd88a;
  border: none;
  border-radius: 8px;
  font-size: 16px;
  font-weight: bold;
  cursor: pointer;
}

.footer {
  text-align: center;
  font-size: 12px;
  color: #9bd9c0;
  margin-top: 30px;
}
</style>
</head>

<body>

<div class="container">
<h2>Fund Your Account</h2>

<!-- BEP20 -->
<div class="method-card">
  <h3>USDT ‚Äì BSC Network</h3>
  <p class="network">BNB Smart Chain (BEP20)</p>
  <div class="address-box">
    <input id="bep20" value="0x2837db956aba84eb2670d00aeea5c0d8a9e20a01" readonly>
    <button onclick="copyText('bep20')">Copy</button>
  </div>
  <p class="warning">üî¥ Send USDT only via BEP20.</p>
</div>

<!-- TRC20 -->
<div class="method-card">
  <h3>USDT ‚Äì TRON Network</h3>
  <p class="network">TRC20</p>
  <div class="address-box">
    <input id="trc20" value="TJREgZTuTnvRrw5Fme4DDd6hSwCEwxQV3f" readonly>
    <button onclick="copyText('trc20')">Copy</button>
  </div>
  <p class="warning">üî¥ Send USDT only via TRC20.</p>
</div>

<!-- Binance -->
<div class="method-card highlight">
  <h3>Direct Binance Transfer</h3>
  <p class="network">Internal Binance ID</p>
  <div class="address-box">
    <input id="binance" value="809423171" readonly>
    <button onclick="copyText('binance')">Copy</button>
  </div>
  <p class="note">‚úÖ No blockchain fees</p>
</div>

<!-- Upload -->
<div class="upload-card">
  <h3>Upload Transaction Proof</h3>
<div id="previewBox" style="display:none;margin-bottom:12px;">
  <p style="font-size:13px;color:#a7ffcf;">Selected proof:</p>
  <img id="imagePreview" style="max-width:100%;border-radius:8px;display:none;">
  <p id="filePreview" style="font-size:13px;"></p>
</div>
  <label>Payment Method Used</label>
  <select id="method">
    <option value="">Select method</option>
    <option>USDT - BEP20 (BSC)</option>
    <option>USDT - TRC20 (TRON)</option>
    <option>Binance ID Transfer</option>
  </select>

  <label>Amount Sent (USDT)</label>
  <input id="amount" type="number">

  <label>Transaction Proof</label>
  <input id="proof" type="file" accept="image/*,.pdf">

  <p class="warning" id="status"></p>

  <button class="submit-btn" id="submitBtn">Submit Proof</button>
</div>

<div class="footer">¬© 2026 Trust ZedFund</div>
</div>

<script type="module">
import { auth, submitDepositProof } from "./firebase.js";
import { onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-auth.js";

let currentUser = null;

const status = document.getElementById("status");
const submitBtn = document.getElementById("submitBtn");

const methodEl = document.getElementById("method");
const amountEl = document.getElementById("amount");
const proofEl  = document.getElementById("proof");
const previewBox   = document.getElementById("previewBox");
const imagePreview = document.getElementById("imagePreview");
const filePreview  = document.getElementById("filePreview");

proofEl.addEventListener("change", () => {
  const file = proofEl.files[0];

  if (!file) {
    previewBox.style.display = "none";
    return;
  }

  previewBox.style.display = "block";
  imagePreview.style.display = "none";
  filePreview.textContent = "";

  if (file.type.startsWith("image/")) {
    const reader = new FileReader();
    reader.onload = e => {
      imagePreview.src = e.target.result;
      imagePreview.style.display = "block";
    };
    reader.readAsDataURL(file);
  } else {
    filePreview.textContent = `üìÑ ${file.name}`;
  }
});

onAuthStateChanged(auth, user => {
  if (!user) {
    status.textContent = "‚ùå Please login to submit proof.";
    submitBtn.disabled = true;
  } else {
    currentUser = user;
    submitBtn.disabled = false;
  }
});

submitBtn.addEventListener("click", async () => {
  if (submitBtn.disabled) return;

  const method = methodEl.value;
  const amount = Number(amountEl.value);
  const file   = proofEl.files[0];

  if (!method || !amount || !file) {
    status.textContent = "‚ö† Please complete all fields.";
    return;
  }

  submitBtn.disabled = true;
  submitBtn.textContent = "Uploading 0%";
  status.textContent = "‚è≥ Uploading transaction proof‚Ä¶ (0%)";

  try {
    await submitDepositProof(
      currentUser.uid,
      { method, amount },
      new File([file], file.name, { type: file.type }),
      percent => {
        submitBtn.textContent = `Uploading ${percent}%`;
        status.textContent = `‚è≥ Uploading transaction proof‚Ä¶ (${percent}%)`;
      }
    );

    submitBtn.textContent = "‚úî Submitted";
    status.textContent = "‚úÖ Deposit submitted successfully. Await approval.";

  } catch (err) {
    console.error(err);
    submitBtn.disabled = false;
    submitBtn.textContent = "Submit Proof";
    status.textContent = "‚ùå " + err.message;
  }
});

</script>
<script>
function copyText(id) {
  const el = document.getElementById(id);
  navigator.clipboard.writeText(el.value);
  alert("Copied successfully!");
}
</script>

</body>
</html>

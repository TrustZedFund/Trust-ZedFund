<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Investment Plans</title>

<style>
:root {
  --card: linear-gradient(135deg, #10c7a7, #0b5f56);
  --accent: #22ff9a;
  --text: #ffffff;
  --muted: #d6f1ec;
}
* { box-sizing:border-box; font-family:system-ui,sans-serif; }
body { margin:0; background:#f4f7f7; }
header { padding:22px; background:#083a34; color:white; }
.container { padding:16px; }

.plan {
  background:var(--card);
  border-radius:18px;
  padding:20px;
  margin-bottom:18px;
  color:var(--text);
}
.plan h3 { margin:0 0 6px; }
.plan small { color:var(--muted); }

.grid {
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
  margin-top:14px;
  font-size:14px;
}

.calc {
  margin-top:14px;
  background:rgba(255,255,255,0.15);
  border-radius:14px;
  padding:14px;
}

.calc input {
  width:100%;
  padding:10px;
  border-radius:8px;
  border:none;
  margin-top:6px;
}

.note {
  font-size:13px;
  margin-top:8px;
  color:#e8fffb;
}

button {
  width:100%;
  padding:14px;
  border-radius:30px;
  border:none;
  font-weight:600;
  background:linear-gradient(90deg,var(--accent),#00d4ff);
  color:#00352f;
  cursor:pointer;
  margin-top:16px;
}
</style>
</head>

<body>

<header>
  <h2>Investment Plans</h2>
  <p>Earn daily. Get paid at maturity.</p>
</header>

<div class="container">

<!-- STARTER -->
<div class="plan">
  <h3>Starter Plan</h3>
  <small>Payout after 30 days</small>
  <div class="grid">
    <div>Minimum<br><strong>ZMK 500</strong></div>
    <div>Daily Profit<br><strong>ZMK 10 / 500</strong></div>
    <div>Days<br>30</div>
    <div>Payout<br>Maturity</div>
  </div>
  <div class="calc">
    <label>Amount</label>
    <input id="starterAmount" type="number" min="500"
      placeholder="Minimum ZMK 500"
      oninput="calc(this.value,30,'starterNote')" />
    <div id="starterNote" class="note"></div>
  </div>
  <button onclick="investPlan('Starter Plan',30,'starterAmount')">Invest</button>
</div>

<!-- GROWTH -->
<div class="plan">
  <h3>Growth Plan</h3>
  <small>Payout after 60 days</small>
  <div class="grid">
    <div>Minimum<br><strong>ZMK 500</strong></div>
    <div>Daily Profit<br><strong>ZMK 10 / 500</strong></div>
    <div>Days<br>60</div>
    <div>Payout<br>Maturity</div>
  </div>
  <div class="calc">
    <label>Amount</label>
    <input id="growthAmount" type="number" min="500"
      placeholder="Minimum ZMK 500"
      oninput="calc(this.value,60,'growthNote')" />
    <div id="growthNote" class="note"></div>
  </div>
  <button onclick="investPlan('Growth Plan',60,'growthAmount')">Invest</button>
</div>

<!-- PREMIUM -->
<div class="plan">
  <h3>Premium Plan</h3>
  <small>Payout after 90 days</small>
  <div class="grid">
    <div>Minimum<br><strong>ZMK 500</strong></div>
    <div>Daily Profit<br><strong>ZMK 10 / 500</strong></div>
    <div>Days<br>90</div>
    <div>Payout<br>Maturity</div>
  </div>
  <div class="calc">
    <label>Amount</label>
    <input id="premiumAmount" type="number" min="500"
      placeholder="Minimum ZMK 500"
      oninput="calc(this.value,90,'premiumNote')" />
    <div id="premiumNote" class="note"></div>
  </div>
  <button onclick="investPlan('Premium Plan',90,'premiumAmount')">Invest</button>
</div>

</div>

<!-- âœ… ONLY THIS IMPORT -->
<script type="module">
import { createInvestment } from "./firebase.js";

const uid = localStorage.getItem("uid");

if (!uid) {
  window.location.href = "login.html";
}

window.investPlan = async function(planName, days, inputId) {
  const amount = Number(document.getElementById(inputId).value);

  if (!amount || amount < 500) {
    alert("Minimum investment is ZMK 500");
    return;
  }

  try {
    await createInvestment(uid, { name: planName, days }, amount);
    alert("Investment successful");
    window.location.href = "dashboard.html";
  } catch (err) {
    if (err.message.includes("Insufficient")) {
      alert("Insufficient balance. Please deposit first.");
      window.location.href = "wallet.html";
    } else {
      alert(err.message);
    }
  }
};
</script>

<script>
function calc(amount, days, out) {
  amount = Number(amount);
  if (!amount || amount < 500) {
    document.getElementById(out).innerText = "Minimum ZMK 500";
    return;
  }
  const daily = (amount / 500) * 10;
  const profit = daily * days;
  document.getElementById(out).innerHTML =
    `Daily: ZMK ${daily.toFixed(2)}<br>
     Profit: ZMK ${profit.toFixed(2)}<br>
     Total: <strong>ZMK ${(amount + profit).toFixed(2)}</strong>`;
}
</script>

</body>
</html>
